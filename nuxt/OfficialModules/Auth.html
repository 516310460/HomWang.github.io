<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>🔑 Auth | Hom Wang</title>
    <meta name="description" content="Vue.js、Nuxt.js、Node.js、Flutter">
    <link rel="icon" href="/img/logo.png">
    
    <link rel="preload" href="/assets/css/0.styles.5d3f4931.css" as="style"><link rel="preload" href="/assets/js/app.8b859a51.js" as="script"><link rel="preload" href="/assets/js/17.756ddfae.js" as="script"><link rel="prefetch" href="/assets/js/10.56150da0.js"><link rel="prefetch" href="/assets/js/11.ff18f93e.js"><link rel="prefetch" href="/assets/js/12.8ccd9dad.js"><link rel="prefetch" href="/assets/js/13.45786c14.js"><link rel="prefetch" href="/assets/js/14.904ec949.js"><link rel="prefetch" href="/assets/js/15.b7ea1a52.js"><link rel="prefetch" href="/assets/js/16.c4df2ec6.js"><link rel="prefetch" href="/assets/js/18.3b7c3d4f.js"><link rel="prefetch" href="/assets/js/19.af50a596.js"><link rel="prefetch" href="/assets/js/2.32a64be5.js"><link rel="prefetch" href="/assets/js/20.a31e193d.js"><link rel="prefetch" href="/assets/js/21.dd993842.js"><link rel="prefetch" href="/assets/js/22.dc5824a6.js"><link rel="prefetch" href="/assets/js/23.5841e562.js"><link rel="prefetch" href="/assets/js/24.fe1c7f1c.js"><link rel="prefetch" href="/assets/js/25.91e44893.js"><link rel="prefetch" href="/assets/js/26.29ceae3c.js"><link rel="prefetch" href="/assets/js/27.4b292fa0.js"><link rel="prefetch" href="/assets/js/28.c7a0f9ed.js"><link rel="prefetch" href="/assets/js/3.1cf7c247.js"><link rel="prefetch" href="/assets/js/4.48677fe4.js"><link rel="prefetch" href="/assets/js/5.af7c2acd.js"><link rel="prefetch" href="/assets/js/6.b29e9b12.js"><link rel="prefetch" href="/assets/js/7.8374bf16.js"><link rel="prefetch" href="/assets/js/8.ba85b023.js"><link rel="prefetch" href="/assets/js/9.c7e223ec.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5d3f4931.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Hom Wang</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/nuxt/introduction.html" class="nav-link">Nuxt.js</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">了解更多</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/516310460" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/jakeWangHong" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.jianshu.com/u/0cd8d9f167dc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://vuejs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue.js
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://nuxtjs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nuxt.js
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/nuxt/introduction.html" class="nav-link">Nuxt.js</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">了解更多</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/516310460" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/jakeWangHong" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.jianshu.com/u/0cd8d9f167dc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://vuejs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue.js
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://nuxtjs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nuxt.js
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/nuxt/introduction.html" class="sidebar-link">介绍</a></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>官方模块</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/nuxt/OfficialModules/Apollo.html" class="sidebar-link">⚡ Apollo</a></li><li><a href="/nuxt/OfficialModules/Auth.html" class="active sidebar-link">🔑 Auth</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#使用" class="sidebar-link">使用</a></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#中间件" class="sidebar-link">中间件</a></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#选项" class="sidebar-link">选项</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#redirect" class="sidebar-link">redirect</a></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#watchloggedin" class="sidebar-link">watchLoggedIn</a></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#token" class="sidebar-link">token</a></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#localstorage" class="sidebar-link">localStorage</a></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#cookie" class="sidebar-link">cookie</a></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#plugins" class="sidebar-link">plugins</a></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#resetonerror" class="sidebar-link">resetOnError</a></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#rewriteredirects" class="sidebar-link">rewriteRedirects</a></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#fullpathredirect" class="sidebar-link">fullPathRedirect</a></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#vuex-namespace" class="sidebar-link">vuex.namespace</a></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#scopekey" class="sidebar-link">scopeKey</a></li></ul></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#参考" class="sidebar-link">参考</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#schemes" class="sidebar-link">Schemes</a></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#local" class="sidebar-link">Local</a></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#oauth2" class="sidebar-link">Oauth2</a></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#providers" class="sidebar-link">Providers</a></li></ul></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#api" class="sidebar-link">API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#auth" class="sidebar-link">Auth</a></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#storage" class="sidebar-link">Storage</a></li></ul></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#recipes" class="sidebar-link">Recipes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#extend-auth" class="sidebar-link">Extend Auth</a></li></ul></li><li class="sidebar-sub-header"><a href="/nuxt/OfficialModules/Auth.html#链接" class="sidebar-link">链接</a></li></ul></li><li><a href="/nuxt/OfficialModules/Axios.html" class="sidebar-link">📦 Axios</a></li><li><a href="/nuxt/OfficialModules/Dotenv.html" class="sidebar-link">📦 Dotenv</a></li><li><a href="/nuxt/OfficialModules/PWA.html" class="sidebar-link">⚡ PWA</a></li><li><a href="/nuxt/OfficialModules/Yamlful.html" class="sidebar-link">📦 Yamlful</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>社区模块</span> <!----></p> <ul class="sidebar-group-items"></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>其他模块</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/nuxt/OtherModules/guess.html" class="sidebar-link">⚡ Guess.js</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>工具</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/nuxt/Tools/nuxt-generate-cluster.html" class="sidebar-link">Nuxt.js 多线程生成命令</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>教程</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/nuxt/Tutorials/pm2.html" class="sidebar-link">pm2 零停机部署</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="🔑-auth"><a href="#🔑-auth" aria-hidden="true" class="header-anchor">#</a> 🔑 Auth</h1> <blockquote><p>Nuxt.js的身份认证模块</p></blockquote> <h2 id="使用"><a href="#使用" aria-hidden="true" class="header-anchor">#</a> 使用</h2> <p>yarn 和 npm 安装:</p> <div class="language-js extra-class"><pre class="language-js"><code>yarn add @nuxtjs<span class="token operator">/</span>auth @nuxtjs<span class="token operator">/</span>axios
<span class="token constant">OR</span>
npm install @nuxtjs<span class="token operator">/</span>auth @nuxtjs<span class="token operator">/</span>axios
</code></pre></div><p>nuxt.config.js</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  modules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">'@nuxtjs/axios'</span><span class="token punctuation">,</span>
    <span class="token string">'@nuxtjs/auth'</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
​
  auth<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// Options</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>添加到新的Nuxt项目时，请确保已使用了Vuex存储。有关如何执行此操作的更多信息，请参阅 <code>auth-moduleNuxt</code> <a href="https://nuxtjs.org/guide/vuex-store" target="_blank" rel="noopener noreferrer">入门指南<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="中间件"><a href="#中间件" aria-hidden="true" class="header-anchor">#</a> 中间件</h2> <p>可以在全局或每条路由启用 <code>auth</code> 中间件。当在路由上启用此中间件并且 <code>loggedIn</code> 为 <code>false</code> 时，用户将被重定向到 <code>redirect.login</code> 路由。(默认为 <code>/login</code>)</p> <p>路由设置:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  middleware<span class="token punctuation">:</span> <span class="token string">'auth'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在nuxt.config.js中使用全局配置:</p> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  middleware<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'auth'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在全局使用的情况下，您可以在特定组件中将 <code>auth</code> 选项设置为 <code>false</code>，而中间件将忽略该路由。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  auth<span class="token punctuation">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="选项"><a href="#选项" aria-hidden="true" class="header-anchor">#</a> 选项</h2> <h3 id="redirect"><a href="#redirect" aria-hidden="true" class="header-anchor">#</a> redirect</h3> <p>默认:</p> <div class="language-js extra-class"><pre class="language-js"><code>redirect<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  login<span class="token punctuation">:</span> <span class="token string">'/login'</span><span class="token punctuation">,</span>
  logout<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
  home<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
  callback<span class="token punctuation">:</span> <span class="token string">'/login'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>login</code>: 如果需要登录，用户将被重定向到此路径。</li> <li><code>logout</code>: 如果在注销后，当前路由受到保护，用户将被重定向到此路径。</li> <li><code>home</code>: 登录后，用户将重定向到此路径。（将重写此路径）</li> <li><code>callback</code>: 登录后，将用户重定向到此路径。（应该配置匹配 <code>允许回调URL</code> （或类似设置）在你的应用程序/客户端。</li></ul> <p>通过设置为false，可以禁用每个重定向路径。还可以通过将 <code>redirect</code> 设置为 <code>false</code> 禁用所有重定向</p> <h3 id="watchloggedin"><a href="#watchloggedin" aria-hidden="true" class="header-anchor">#</a> watchLoggedIn</h3> <ul><li>Default: <code>true</code></li></ul> <p>当启用（默认）时，用户将在登录/注销时重定向。</p> <h3 id="token"><a href="#token" aria-hidden="true" class="header-anchor">#</a> token</h3> <p>Auth token在用户登录时存储在各种存储（cookie、localStorage、vuex）中，以提供跨服务器端呈现（SSR）和客户端呈现的无缝auth体验。token以以下格式的存储键存储:<code>{storageProvider.prefix}{token.prefix}{strategy}</code>。有关详细信息，请参阅<a href="https://github.com/nuxt-community/auth-module/blob/master/lib/core/auth.js#L160" target="_blank" rel="noopener noreferrer">auth.js - Token helpers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>帮助程序和<a href="https://github.com/nuxt-community/auth-module/blob/master/lib/core/storage.js" target="_blank" rel="noopener noreferrer">storage.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>默认:</p> <div class="language-js extra-class"><pre class="language-js"><code>token<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  prefix<span class="token punctuation">:</span> <span class="token string">'_token.'</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>prefix - 用于构建跨所有存储token密钥的前缀</li></ul> <h3 id="localstorage"><a href="#localstorage" aria-hidden="true" class="header-anchor">#</a> localStorage</h3> <p>默认:</p> <div class="language-js extra-class"><pre class="language-js"><code>localStorage<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  prefix<span class="token punctuation">:</span> <span class="token string">'auth.'</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>prefix - token前缀，用于浏览器本地存储中的token存储构建密钥</li></ul> <p>可以通过将 <code>localStorage</code> 设置为 <code>false</code> 来禁用localStorage的使用，如下:</p> <div class="language-js extra-class"><pre class="language-js"><code>localStorage<span class="token punctuation">:</span> <span class="token boolean">false</span>
</code></pre></div><p>否则，身份验证token将以默认密钥存储在localStorage中: auth._token.{provider}。</p> <h3 id="cookie"><a href="#cookie" aria-hidden="true" class="header-anchor">#</a> cookie</h3> <p>默认:</p> <div class="language-js extra-class"><pre class="language-js"><code>cookie<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  prefix<span class="token punctuation">:</span> <span class="token string">'auth.'</span><span class="token punctuation">,</span>
  options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> <span class="token string">'/'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>prefix - 在浏览器的localStorage中为token存储构建密钥时使用的默认前缀</li> <li>options - cookie选项，通过<a href="https://github.com/js-cookie/js-cookie" target="_blank" rel="noopener noreferrer">js-cookie<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <code>set</code> 和 <code>get</code>函数。有关它们支持的选项及其默认值的详细信息，请参阅<a href="https://github.com/js-cookie/js-cookie#cookie-attributes" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，包括:
<ul><li><code>path</code> - cookie的路径。默认为 '/'。</li> <li><code>expires</code> - 可以用来指定cookie生存期的天数或特定日期，默认为 session。</li> <li><code>domain</code> - cookie中可以看到的域（以及扩展子域/s）。默认是域和所有子域。</li> <li><code>secure</code> - 这是一个安全协议(https)。默认是false。如果可能，应该设置为true。</li></ul></li></ul> <p>注意: 要使用JWT token，SSR请求需要使用cookie。</p> <p>通过将 <code>cookie</code> 设置为 <code>false</code>，可以禁用cookie存储。如下:</p> <div class="language-js extra-class"><pre class="language-js"><code>cookie<span class="token punctuation">:</span> <span class="token boolean">false</span>
</code></pre></div><p>否则这个auth token将存储在默认名为: <code>auth._token.{provider}</code>。</p> <h3 id="plugins"><a href="#plugins" aria-hidden="true" class="header-anchor">#</a> plugins</h3> <p>如果您有任何依赖于$auth的nuxt插件，则必须在这里指定它，而不是在nuxt.config.js插件选项中指定。</p> <p><a href="#recipes">扩展验证</a></p> <h3 id="resetonerror"><a href="#resetonerror" aria-hidden="true" class="header-anchor">#</a> resetOnError</h3> <ul><li>Default: <code>false</code></li></ul> <p>如果启用，如果发生任何错误，用户将自动注销（例如token过期）</p> <h3 id="rewriteredirects"><a href="#rewriteredirects" aria-hidden="true" class="header-anchor">#</a> rewriteRedirects</h3> <ul><li>Default: <code>true</code></li></ul> <p>如果启用，用户将重定向回原来的路由，而不是redirect.home</p> <h3 id="fullpathredirect"><a href="#fullpathredirect" aria-hidden="true" class="header-anchor">#</a> fullPathRedirect</h3> <ul><li>Default: <code>false</code></li></ul> <p>如果为true，则使用于带有重定向查询参数的完整路由路径。</p> <h3 id="vuex-namespace"><a href="#vuex-namespace" aria-hidden="true" class="header-anchor">#</a> vuex.namespace</h3> <ul><li>Default: <code>auth</code></li></ul> <p>vuex存储用于保持状态的管理器。</p> <h3 id="scopekey"><a href="#scopekey" aria-hidden="true" class="header-anchor">#</a> scopeKey</h3> <ul><li>Default: <code>scope</code></li></ul> <p>用于范围检查的 <code>user</code> 对象属性（hasScope），可以是数组也可以是对象。</p> <h2 id="参考"><a href="#参考" aria-hidden="true" class="header-anchor">#</a> 参考</h2> <h3 id="schemes"><a href="#schemes" aria-hidden="true" class="header-anchor">#</a> <strong>Schemes</strong></h3> <p>方案定义了身份验证逻辑。策略是Scheme的可配置实例。您可以在项目中使用多个方案和策略。</p> <p><code>auth.strategies</code> 选项是一个对象。键是策略名称，值是配置。</p> <div class="language-js extra-class"><pre class="language-js"><code>auth<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  strategies<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    local<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    github<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>默认情况下，实例名称与方案名称相同，如果希望通过提供自己的方案或具有相同方案的多个实例获得更大的扩展性，可以使用 <code>_scheme</code> 属性:</p> <div class="language-js extra-class"><pre class="language-js"><code>auth<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  strategies<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    local1<span class="token punctuation">:</span> <span class="token punctuation">{</span> _scheme<span class="token punctuation">:</span> <span class="token string">'local'</span><span class="token punctuation">,</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    local2<span class="token punctuation">:</span> <span class="token punctuation">{</span> _scheme<span class="token punctuation">:</span> <span class="token string">'local'</span><span class="token punctuation">,</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    custom<span class="token punctuation">:</span> <span class="token punctuation">{</span> _scheme<span class="token punctuation">:</span> <span class="token string">'~/app/customStrategy.js'</span><span class="token punctuation">,</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="local"><a href="#local" aria-hidden="true" class="header-anchor">#</a> Local</h3> <p><a href="https://github.com/nuxt-community/auth-module/blob/dev/lib/schemes/local.js" target="_blank" rel="noopener noreferrer">源码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><code>local</code> 是默认通用认证方案，支持 <code>Cookie</code> 和 <code>JWT</code> 登录流程。</p> <p>默认情况下启用和预配置local方案。</p> <blockquote><p>提示：您可以将 <code>strategies.local</code> 设置 <code>false</code> 以禁用它。</p></blockquote> <h4 id="用法"><a href="#用法" aria-hidden="true" class="header-anchor">#</a> 用法</h4> <div class="language-js extra-class"><pre class="language-js"><code>auth<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  strategies<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    local<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      endpoints<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        login<span class="token punctuation">:</span> <span class="token punctuation">{</span> url<span class="token punctuation">:</span> <span class="token string">'/api/auth/login'</span><span class="token punctuation">,</span> method<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span> propertyName<span class="token punctuation">:</span> <span class="token string">'token'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        logout<span class="token punctuation">:</span> <span class="token punctuation">{</span> url<span class="token punctuation">:</span> <span class="token string">'/api/auth/logout'</span><span class="token punctuation">,</span> method<span class="token punctuation">:</span> <span class="token string">'post'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        user<span class="token punctuation">:</span> <span class="token punctuation">{</span> url<span class="token punctuation">:</span> <span class="token string">'/api/auth/user'</span><span class="token punctuation">,</span> method<span class="token punctuation">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span> propertyName<span class="token punctuation">:</span> <span class="token string">'user'</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// tokenRequired: true,</span>
      <span class="token comment">// tokenType: 'bearer',</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="endpoints"><a href="#endpoints" aria-hidden="true" class="header-anchor">#</a> endpoints</h4> <p>每个属性用于使用axios进行请求。它们基本上扩展了Axios <a href="https://github.com/axios/axios#request-config" target="_blank" rel="noopener noreferrer">请求配置<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p>提示：要禁用每个属性，只需将其值设置为false。</p></blockquote> <h4 id="propertyname"><a href="#propertyname" aria-hidden="true" class="header-anchor">#</a> propertyName</h4> <p><code>propertyName</code> 可用于指定使用响应JSON的哪个字段作为值。<code>undefined</code> 可以直接使用API​​响应，或者像 <code>auth.user</code> 更复杂。</p> <h4 id="tokenrequired"><a href="#tokenrequired" aria-hidden="true" class="header-anchor">#</a> tokenRequired</h4> <p>此选项可用于禁用所有token。仅用于Cookie。</p> <h4 id="tokentype"><a href="#tokentype" aria-hidden="true" class="header-anchor">#</a> tokenType</h4> <ul><li>Default: <code>Bearer</code></li></ul> <p>在axios请求中使用的授权头类型。</p> <h4 id="使用-2"><a href="#使用-2" aria-hidden="true" class="header-anchor">#</a> 使用</h4> <p>通过将凭据作为JSON对象在请求体中发送，执行基于密码的登录:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span><span class="token function">loginWith</span><span class="token punctuation">(</span><span class="token string">'local'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    username<span class="token punctuation">:</span> <span class="token string">'your_username'</span><span class="token punctuation">,</span>
    password<span class="token punctuation">:</span> <span class="token string">'your_password'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="oauth2"><a href="#oauth2" aria-hidden="true" class="header-anchor">#</a> Oauth2</h3> <p><a href="https://github.com/nuxt-community/auth-module/blob/dev/lib/schemes/oauth2.js" target="_blank" rel="noopener noreferrer">源码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><code>oauth2</code> 支持各种oauth2登录流程。您也可以自定义配置，而不是直接使用此方案。</p> <h4 id="用法-2"><a href="#用法-2" aria-hidden="true" class="header-anchor">#</a> 用法</h4> <div class="language-js extra-class"><pre class="language-js"><code>auth<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  strategies<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    social<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      _scheme<span class="token punctuation">:</span> <span class="token string">'oauth2'</span><span class="token punctuation">,</span>
      authorization_endpoint<span class="token punctuation">:</span> <span class="token string">'https://accounts.google.com/o/oauth2/auth'</span><span class="token punctuation">,</span><span class="token punctuation">(</span>必选<span class="token punctuation">)</span>
      userinfo_endpoint<span class="token punctuation">:</span> <span class="token string">'https://www.googleapis.com/oauth2/v3/userinfo'</span><span class="token punctuation">,</span><span class="token punctuation">(</span>必选<span class="token punctuation">)</span>
      scope<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'openid'</span><span class="token punctuation">,</span> <span class="token string">'profile'</span><span class="token punctuation">,</span> <span class="token string">'email'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      response_type<span class="token punctuation">:</span> <span class="token string">'token'</span><span class="token punctuation">,</span>
      token_type<span class="token punctuation">:</span> <span class="token string">'Bearer'</span><span class="token punctuation">,</span>
      redirect_uri<span class="token punctuation">:</span> undefined<span class="token punctuation">,</span>
      client_id<span class="token punctuation">:</span> <span class="token string">'SET_ME'</span><span class="token punctuation">,</span><span class="token punctuation">(</span>必选<span class="token punctuation">)</span>
      token_key<span class="token punctuation">:</span> <span class="token string">'access_token'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="authorization-endpoint"><a href="#authorization-endpoint" aria-hidden="true" class="header-anchor">#</a> authorization_endpoint</h4> <p>必选 - 启动登录流程的属性。取决于oauth服务。</p> <h4 id="userinfo-endpoint"><a href="#userinfo-endpoint" aria-hidden="true" class="header-anchor">#</a> userinfo_endpoint</h4> <p>虽然不是oauth2规范的一部分，几乎所有的oauth2都公开这个属性以获取用户配置文件。如果设置了错误值，我们只登录而不获取用户配置文件。</p> <h4 id="scope"><a href="#scope" aria-hidden="true" class="header-anchor">#</a> scope</h4> <p>必选 - Oauth2访问范围</p> <h4 id="response-type"><a href="#response-type" aria-hidden="true" class="header-anchor">#</a> response_type</h4> <p>默认值是 <code>token</code>，如果使用 <code>code</code>，则必须实现服务器端逻辑来对响应代码进行签名。</p> <h4 id="token-type"><a href="#token-type" aria-hidden="true" class="header-anchor">#</a> token_type</h4> <p>默认值是 <code>Bearer</code>，它将用于axios请求的 <code>Authorization</code> 头部。</p> <h4 id="redirect-uri"><a href="#redirect-uri" aria-hidden="true" class="header-anchor">#</a> redirect_uri</h4> <p>默认情况下，它将从<code>redirect.callback</code>选项推断。(默认为 <code>/login</code>)</p> <p>应该与登录页面或相对路径相同的页面。<a href="https://github.com/nuxt-community/auth-module/blob/dev/examples/demo/pages/callback.vue" target="_blank" rel="noopener noreferrer">示例<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="client-id"><a href="#client-id" aria-hidden="true" class="header-anchor">#</a> client_id</h4> <p>必选 - oauth2客户端ID。</p> <h4 id="token-key"><a href="#token-key" aria-hidden="true" class="header-anchor">#</a> token_key</h4> <p>默认情况下，设置为token_key: <code>access_token</code>。如果需要使用IdToken而不是AccessToken，将此选项设置为token_key：<code>id_token</code>。</p> <h4 id="refresh-token-key"><a href="#refresh-token-key" aria-hidden="true" class="header-anchor">#</a> refresh_token_key</h4> <p>默认情况下，设置为refresh_token_key: <code>refresh_token</code>。如果存在，它将自动存储refresh_token。</p> <h4 id="使用-3"><a href="#使用-3" aria-hidden="true" class="header-anchor">#</a> 使用</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span><span class="token function">loginWith</span><span class="token punctuation">(</span><span class="token string">'social'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="providers"><a href="#providers" aria-hidden="true" class="header-anchor">#</a> Providers</h3> <p>Providers 是Schemes之上的抽象。它们使得与流行的身份验证服务集成变得非常容易。他们可以通过提供程序所需的服务器端更改（例如 token 签名）执行更多操作，您也可以自己编写。</p> <p><a href="https://github.com/nuxt-community/auth-module/blob/dev/lib/providers/auth0.js" target="_blank" rel="noopener noreferrer">源码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="用法-3"><a href="#用法-3" aria-hidden="true" class="header-anchor">#</a> 用法</h4> <div class="language-js extra-class"><pre class="language-js"><code>auth<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  strategies<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    auth0<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      domain<span class="token punctuation">:</span> <span class="token string">'domain.auth0.com'</span><span class="token punctuation">,</span>
      client_id<span class="token punctuation">:</span> <span class="token string">'....'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在项目逻辑中的任何地方:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span><span class="token function">loginWith</span><span class="token punctuation">(</span><span class="token string">'auth0'</span><span class="token punctuation">)</span>
</code></pre></div><p>用户将被重定向到如下页面:</p> <p><img src="/assets/img/hosted-login.41f4f396.png" alt="hosted-login"></p> <p>💁此程序基于<a href="#oauth2">oauth2方案</a>，并支持所有方案选项。</p> <p>获取 <code>client_id</code> and <code>domain</code></p> <p>需要这些选项。您的应用程序需要关于这个客户端的一些细节来与Auth0通信。您可以从 <a href="https://auth0.auth0.com/login?state=g6Fo2SBWajVOV2w4b3FULXlEMzJlT3F2NWRHWnhldHlCSFZsdaN0aWTZMmdhRm8yU0EyV2sxNU0xSXlibnBmTlRSSlUzTkhkVVZsVVROSlZIWTFla2hhUTBrMVpno2NpZNkgekVZZnBvRnpVTUV6aWxoa0hpbGNXb05rckZmSjNoQUk&client=zEYfpoFzUMEzilhkHilcWoNkrFfJ3hAI&protocol=oauth2&response_type=code&redirect_uri=https%3A%2F%2Fmanage.auth0.com%2Fcallback&scope=openid%20profile%20name%20email%20nickname%20created_at" target="_blank" rel="noopener noreferrer">Auth0 dashboard<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 中的客户端设置部分获得这些详细信息。</p> <p><img src="/assets/img/client_settings.5d746055.png" alt="client_settings"></p> <h4 id="facebook"><a href="#facebook" aria-hidden="true" class="header-anchor">#</a> Facebook</h4> <p><a href="https://github.com/nuxt-community/auth-module/blob/dev/lib/providers/facebook.js" target="_blank" rel="noopener noreferrer">源码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code>auth<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  strategies<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    facebook<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      client_id<span class="token punctuation">:</span> <span class="token string">'...'</span><span class="token punctuation">,</span>
      userinfo_endpoint<span class="token punctuation">:</span> <span class="token string">'https://graph.facebook.com/v2.12/me?fields=about,name,picture{url},email,birthday'</span><span class="token punctuation">,</span>
      scope<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'public_profile'</span><span class="token punctuation">,</span> <span class="token string">'email'</span><span class="token punctuation">,</span> <span class="token string">'user_birthday'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在项目逻辑中的任何地方:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span><span class="token function">loginWith</span><span class="token punctuation">(</span><span class="token string">'social'</span><span class="token punctuation">)</span>
</code></pre></div><p>💁此程序基于<a href="#oauth2">oauth2方案</a>，并支持所有方案选项。</p> <p>获取 <code>client_id</code></p> <p>此选项是必需的。要获得一个，请在<a href="https://developers.facebook.com/" target="_blank" rel="noopener noreferrer">Facebook Developers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>中创建您的应用程序并添加&quot;Facebook Login&quot;产品。然后设置有效的回调URL。客户端ID与&quot;App ID&quot;相同。</p> <h4 id="github"><a href="#github" aria-hidden="true" class="header-anchor">#</a> Github</h4> <p><a href="https://github.com/nuxt-community/auth-module/blob/dev/lib/providers/github.js" target="_blank" rel="noopener noreferrer">源码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code>auth<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  strategies<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      github<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        client_id<span class="token punctuation">:</span> <span class="token string">'...'</span><span class="token punctuation">,</span>
        client_secret<span class="token punctuation">:</span> <span class="token string">'...'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在项目逻辑中的任何地方:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span><span class="token function">loginWith</span><span class="token punctuation">(</span><span class="token string">'github'</span><span class="token punctuation">)</span>
</code></pre></div><p>💁此程序基于<a href="#oauth2">oauth2方案</a>，并支持所有方案选项。</p> <p>获取 <code>client_id</code> 和 <code>client_secret</code></p> <p>此选项是必需的。要获得一个，请在创建新的<a href="https://github.com/settings/applications/new" target="_blank" rel="noopener noreferrer">Oauth APP<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>中创建您的应用程序，并使用提供的&quot;客户端ID&quot;和&quot;客户端密钥&quot;。</p> <h4 id="google"><a href="#google" aria-hidden="true" class="header-anchor">#</a> Google</h4> <p><a href="https://github.com/nuxt-community/auth-module/blob/dev/lib/providers/google.js" target="_blank" rel="noopener noreferrer">源码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code>auth<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  strategies<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      google<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        client_id<span class="token punctuation">:</span> <span class="token string">'...'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在项目逻辑中的任何地方:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span><span class="token function">loginWith</span><span class="token punctuation">(</span><span class="token string">'google'</span><span class="token punctuation">)</span>
</code></pre></div><p>💁此程序基于<a href="#oauth2">oauth2方案</a>，并支持所有方案选项。</p> <p>获取 <code>client_id</code></p> <p>此选项是必需的。要获取一个，请在<a href="https://console.developers.google.com/projectselector/apis/dashboard?supportedpurview=project" target="_blank" rel="noopener noreferrer">Google API控制台中<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>创建您的应用，创建一个新项目，然后从&quot;凭据&quot;标签中创建一个新的&quot;Oauth客户端ID&quot;。</p> <h4 id="laravel-passport"><a href="#laravel-passport" aria-hidden="true" class="header-anchor">#</a> Laravel Passport</h4> <p><a href="https://github.com/nuxt-community/auth-module/blob/dev/lib/providers/laravel.passport.js" target="_blank" rel="noopener noreferrer">源码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code>auth<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  strategies<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">'laravel.passport'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        url<span class="token punctuation">:</span> <span class="token string">'...'</span><span class="token punctuation">,</span>
        client_id<span class="token punctuation">:</span> <span class="token string">'...'</span><span class="token punctuation">,</span>
        client_secret<span class="token punctuation">:</span> <span class="token string">'...'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在项目逻辑中的任何地方:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span><span class="token function">loginWith</span><span class="token punctuation">(</span><span class="token string">'laravel.passport'</span><span class="token punctuation">)</span>
</code></pre></div><p>💁此程序基于<a href="#oauth2">oauth2方案</a>，并支持所有方案选项。</p> <p>获取 <code>url</code>、<code>client_id</code> 和 <code>client_secret</code></p> <p>这些选项是必需的。在<a href="https://laravel.com/docs/5.6/passport#managing-clients" target="_blank" rel="noopener noreferrer">Laravel应用程序<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>中创建一个新的客户端应用程序，并且获取 <code>url</code>、<code>client_id</code> 和 <code>client_secret</code>。</p> <h2 id="api"><a href="#api" aria-hidden="true" class="header-anchor">#</a> API</h2> <h3 id="auth"><a href="#auth" aria-hidden="true" class="header-anchor">#</a> Auth</h3> <p><a href="https://github.com/nuxt-community/auth-module/blob/dev/lib/core/auth.js" target="_blank" rel="noopener noreferrer">源码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>该模块全局注入<code>$auth</code>实例，这意味着您可以使用<code>this.$auth</code>在任何地方访问它。对于plugins、asyncData、fetch、nuxtServerInit和Middleware，您可以从<code>context.app.$auth</code>中访问它。</p> <h4 id="性能"><a href="#性能" aria-hidden="true" class="header-anchor">#</a> 性能</h4> <p>所有属性都是被动的。这意味着您可以在Vue模板<code>v-if</code>条件下安全地使用它们。</p> <h4 id="user"><a href="#user" aria-hidden="true" class="header-anchor">#</a> <code>user</code></h4> <p>此对象包含有关已认证用户的详细信息，例如名称。您可以使用<code>$auth</code>或Vuex 访问它。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 使用 $auth</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span>user
​
<span class="token comment">// 在 vuex 中使用</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>user
</code></pre></div><h4 id="loggedin"><a href="#loggedin" aria-hidden="true" class="header-anchor">#</a> <code>loggedIn</code></h4> <p>此布尔标志表示用户此时已经过身份验证且可用。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 使用 $auth</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span>loggedIn
​
<span class="token comment">// 在 vuex 中使用</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>loggedIn
</code></pre></div><p>在这使用的背后，需要auth使用<a href="#storage">$storage</a>附加实例来提供此状态。</p> <h4 id="methods"><a href="#methods" aria-hidden="true" class="header-anchor">#</a> methods</h4> <p><code>loginWith(strategyName, ...args)</code></p> <ul><li>Returns: <code>Promise</code></li></ul> <p>将当前策略设置为<code>strategyName</code>并尝试登录。用法因当前策略而异。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span><span class="token function">loginWith</span><span class="token punctuation">(</span><span class="token string">'local'</span><span class="token punctuation">,</span> <span class="token comment">/* .... */</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$toast<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'Logged In!'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="login-args"><a href="#login-args" aria-hidden="true" class="header-anchor">#</a> <code>login(...args)</code></h4> <ul><li>Returns: <code>Promise</code></li></ul> <p>使用主动策略登录。用法因当前策略而异。</p> <blockquote><p>提示：建议使用 <code>loginWith</code> 而不是这个函数！</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token comment">/* .... */</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$toast<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'Logged In!'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="logout"><a href="#logout" aria-hidden="true" class="header-anchor">#</a> <code>logout()</code></h4> <ul><li>Returns: <code>Promise</code></li></ul> <p>退出活动策略。用法因当前方案而异。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="fetchuser"><a href="#fetchuser" aria-hidden="true" class="header-anchor">#</a> <code>fetchUser()</code></h4> <ul><li>Returns: <code>Promise</code></li></ul> <p>使用策略强制重新获取用户。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span><span class="token function">fetchUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="hasscope-scopename"><a href="#hasscope-scopename" aria-hidden="true" class="header-anchor">#</a> <code>hasScope(scopeName)</code></h4> <p>检查用户是否具有特定范围：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 返回是一个计算属性的布尔值</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span><span class="token function">hasScope</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="settoken-strategy-token"><a href="#settoken-strategy-token" aria-hidden="true" class="header-anchor">#</a> <code>setToken(strategy, token)</code></h4> <p>通用设置token。该<code>name</code>参数是可选的，默认为<code>options.token.name</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 更新 token</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span><span class="token function">setToken</span><span class="token punctuation">(</span><span class="token string">'local'</span><span class="token punctuation">,</span> <span class="token string">'.....'</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="onerror-handler"><a href="#onerror-handler" aria-hidden="true" class="header-anchor">#</a> <code>onError(handler)</code></h4> <p>侦听身份验证错误: (<code>plugins/auth.js</code>)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">{</span> $auth <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  $auth<span class="token punctuation">.</span><span class="token function">onError</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> name<span class="token punctuation">,</span> endpoint<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="storage"><a href="#storage" aria-hidden="true" class="header-anchor">#</a> Storage</h3> <p><a href="https://github.com/nuxt-community/auth-module/blob/dev/lib/core/storage.js" target="_blank" rel="noopener noreferrer">源码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Auth模块具有强大的内置Universal Storage，可保存token和配置文件数据。</p> <h4 id="universal-storage"><a href="#universal-storage" aria-hidden="true" class="header-anchor">#</a> Universal Storage</h4> <p>普遍vuex保持状态为localStorage和Cookies：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span>$storage<span class="token punctuation">.</span><span class="token function">setUniversal</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> val<span class="token punctuation">,</span> isJson<span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span>$storage<span class="token punctuation">.</span><span class="token function">getUniversal</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> isJson<span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span>$storage<span class="token punctuation">.</span><span class="token function">syncUniversal</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> defaultValue<span class="token punctuation">,</span> isJson<span class="token punctuation">)</span>
</code></pre></div><h4 id="local-stat"><a href="#local-stat" aria-hidden="true" class="header-anchor">#</a> Local Stat</h4> <p>Access to local state:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span>$state
<span class="token comment">// OR</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span>$storage<span class="token punctuation">.</span>$state
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span>$storage<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> val<span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span>$storage<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
​
<span class="token comment">// Watch state changes</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span>$storage<span class="token punctuation">.</span><span class="token function">watchState</span><span class="token punctuation">(</span><span class="token string">'loggedIn'</span><span class="token punctuation">,</span> newValue <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="cookies"><a href="#cookies" aria-hidden="true" class="header-anchor">#</a> Cookies</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span>$storage<span class="token punctuation">.</span><span class="token function">setCookie</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> val<span class="token punctuation">,</span> isJson<span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span>$storage<span class="token punctuation">.</span><span class="token function">getCookie</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
</code></pre></div><h4 id="local-storage"><a href="#local-storage" aria-hidden="true" class="header-anchor">#</a> Local Storage</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span>$storage<span class="token punctuation">.</span><span class="token function">setLocalstorage</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> val<span class="token punctuation">,</span> isJson<span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$auth<span class="token punctuation">.</span>$storage<span class="token punctuation">.</span><span class="token function">getLocalstorage</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
</code></pre></div><h2 id="recipes"><a href="#recipes" aria-hidden="true" class="header-anchor">#</a> Recipes</h2> <h3 id="extend-auth"><a href="#extend-auth" aria-hidden="true" class="header-anchor">#</a> Extend Auth</h3> <p>如果有需要访问$auth的插件，可以使用auth.plugins选项</p> <p><code>nuxt.config.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  modules<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'@nuxtjs/auth'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  auth<span class="token punctuation">:</span> <span class="token punctuation">{</span>
     plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">'~/plugins/auth.js'</span> <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>plugins/auth.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> app <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>app<span class="token punctuation">.</span>$auth<span class="token punctuation">.</span>loggedIn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
​
  <span class="token keyword">const</span> username <span class="token operator">=</span> app<span class="token punctuation">.</span>$auth<span class="token punctuation">.</span>user<span class="token punctuation">.</span>username
<span class="token punctuation">}</span>
</code></pre></div><h2 id="链接"><a href="#链接" aria-hidden="true" class="header-anchor">#</a> 链接</h2> <p><a href="https://github.com/nuxt-community/auth-module/" target="_blank" rel="noopener noreferrer">示例<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://auth.nuxtjs.org/meta/migration" target="_blank" rel="noopener noreferrer">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/nuxt/OfficialModules/Apollo.html" class="prev">
          ⚡ Apollo
        </a></span> <span class="next"><a href="/nuxt/OfficialModules/Axios.html">
          📦 Axios
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.8b859a51.js" defer></script><script src="/assets/js/17.756ddfae.js" defer></script>
  </body>
</html>
